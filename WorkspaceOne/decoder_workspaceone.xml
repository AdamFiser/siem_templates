<!-- 

Syslog decoder Omnissa Workspace One (AirWatch) logs

Author: Adam Fišer
Source: http://github.com/AdamFiser/siem_templates

== Workspace one settings==

Syslog format: RFC-5424
Message tag: AirWatch
Message Content:
source="WorkspaceONE" event_type="{EventType}" event="{Event}" user="{User}"  enrollment_user="{EnrollmentUser}" event_source="{EventSource}" event_module="{EventModule}" event_category="{EventCategory}" event_data="{EventData}" device_friendly_name="{DeviceFriendlyName}"


== Test message ==

2025-08-12T07:23:26.311562Z AirWatch source="WorkspaceONE" event_type="Console" event="AdminUserLoggedIn" user="myLoginName"  enrollment_user="N/A" event_source="Server" event_module="Administration" event_category="Login" event_data="LoginSessionID=gzbwidetqd4r" device_friendly_name="N/A" Event Timestamp: 2025-08-12T07:23:25.780390Z


-->
<!-- Parent: RFC-5424 APP-NAME == AirWatch 
<decoder name="airwatch">
  <program_name>^AirWatch$</program_name>
</decoder>-->

<decoder name="airwatch">
  <prematch>source="WorkspaceONE"</prematch>
</decoder>

  <!-- Jednotlivé klíče (PCRE2) -->
  <decoder name="airwatch-source">
    <parent>airwatch</parent>
    <regex type="pcre2">(?s).*?\bsource="([^"]*)"</regex>
    <order>source</order>
  </decoder>

  <decoder name="airwatch-event_type">
    <parent>airwatch</parent>
    <regex type="pcre2">(?s).*?\bevent_type="([^"]*)"</regex>
    <order>event_type</order>
  </decoder>

  <decoder name="airwatch-event">
    <parent>airwatch</parent>
    <regex type="pcre2">(?s).*?\bevent="([^"]*)"</regex>
    <order>event</order>
  </decoder>

  <decoder name="airwatch-user">
    <parent>airwatch</parent>
    <regex type="pcre2">(?s).*?\buser="([^"]*)"</regex>
    <order>user</order>
  </decoder>

  <decoder name="airwatch-enrollment_user">
    <parent>airwatch</parent>
    <regex type="pcre2">(?s).*?\benrollment_user="([^"]*)"</regex>
    <order>enrollment_user</order>
  </decoder>

  <decoder name="airwatch-event_source">
    <parent>airwatch</parent>
    <regex type="pcre2">(?s).*?\bevent_source="([^"]*)"</regex>
    <order>event_source</order>
  </decoder>

  <decoder name="airwatch-event_module">
    <parent>airwatch</parent>
    <regex type="pcre2">(?s).*?\bevent_module="([^"]*)"</regex>
    <order>event_module</order>
  </decoder>

  <decoder name="airwatch-event_category">
    <parent>airwatch</parent>
    <regex type="pcre2">(?s).*?\bevent_category="([^"]*)"</regex>
    <order>event_category</order>
  </decoder>

  <decoder name="airwatch-event_data">
    <parent>airwatch</parent>
    <regex type="pcre2">(?s).*?\bevent_data="([^"]*)"</regex>
    <order>event_data</order>
  </decoder>

  <decoder name="airwatch-device_friendly_name">
    <parent>airwatch</parent>
    <regex type="pcre2">(?s).*?\bdevice_friendly_name="([^"]*)"</regex>
    <order>device_friendly_name</order>
  </decoder>

  <!-- Volitelné: trailing "Event Timestamp: 2025-..." na konci zprávy -->
  <decoder name="airwatch-event_timestamp">
    <parent>airwatch</parent>
    <regex type="pcre2">Event Timestamp:\h*([0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9:.]+Z)</regex>
    <order>event_timestamp</order>
  </decoder>
